[gcode_macro PRINT_START]
gcode:
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP | float %}
    {% set BED_TEMP = params.BED_TEMP | float %}

    M140 S{BED_TEMP}
    M104 S{EXTRUDER_TEMP * 0.75}

    {% set FLUSH_NOZZLE = ("xyz" in printer.toolhead.homed_axes) and printer.quad_gantry_level.applied %}

    CG32 EXTRUDER_TEMP={EXTRUDER_TEMP} PARK_BED={False}
    SET_FAN_SPEED FAN=Nevermore SPEED=0.9
    _get_bed_mesh BED_TEMP={BED_TEMP} EXTRUDER_TEMP={EXTRUDER_TEMP} PARK_BED={False}

    _status_ready
    PARKPURGE

    _status_heating
    M190 S{BED_TEMP}
    M109 S{EXTRUDER_TEMP}

    {% if FLUSH_NOZZLE %}
        PREPARE_NOZZLE EXTRUDER_TEMP={EXTRUDER_TEMP} SKIP_OOZE_CLEAN={True} ENDING_TEMP={EXTRUDER_TEMP}
    {% endif %}

    _status_printing