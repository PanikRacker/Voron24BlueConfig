[gcode_macro _PARK_SAFE]
gcode:
    {% set location = params.LOCATION | lower %}
    {% set max_z = printer.toolhead.axis_maximum.z | float %}
    {% set current_z = printer.toolhead.position.z | float %}
    _DEBUG MSG="Move toolhead backwards savely"
    CG28
    G90
    {% if current_z < max_z %}
        G0 Z{current_z+5}
    {% endif %}
    G0 Y{printer.toolhead.axis_maximum.y-5}
    PARK LOCATION={location}